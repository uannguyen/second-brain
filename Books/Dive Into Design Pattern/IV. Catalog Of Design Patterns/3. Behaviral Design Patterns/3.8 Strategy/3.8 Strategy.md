
![[oop-180.png]]


# Concept

***Strategy is a behavioral design pattern that lets you define a family of algorithms, put each of them into a separate class, and make their objects interchangeable***

- Strategy là mẫu thiết kế hành vi cho phép bạn định nghĩa một họ các thuật toán, đặt mỗi thuật toán vào một lớp riêng biệt và làm cho các đối tượng của họ có thể hoán đổi cho nhau

 **VD minh họa**:
- *Hãy tưởng tượng chúng ta có một trò chơi mà bạn cần chọn cách di chuyển từ điểm A đến điểm B. Có ba cách di chuyển: đi bộ, đi xe đạp, và đi xe hơi. Mỗi cách di chuyển có tốc độ và chi phí khác nhau*
	- **Context**: Đây là bạn - người cần di chuyển từ điểm A đến điểm B.
	- **Strategy**: Đây là cách bạn chọn để di chuyển (đi bộ, đi xe đạp, hay đi xe hơi).
	- **Concrete Strategies**: Đây là chi tiết về từng cách di chuyển.
- Các chiến lược:
	- Đi bộ: chậm, không tốn tiền
	- Đi xe đạp: Nhanh hơn đi bộ, tốn tiền mua xe
	- Đi xe hơi: Nhanh nhất, tốn nhiều tiền nhất

# Problem

- Một ngày nọ, bạn quyết định tạo một navigation app cho khách du lịch
	- App tập trung vào một beautiful map giúp users nhanh chóng định hướng bản thân ở bất kỳ thành phố nào
- Một trong những features được requested nhiều nhất là lập kế hoạch tuyến đường tự động
	- User có thể enter address và xem tuyến đường nhanh nhất đến đích được hiển thị trên bản đồ
	
- Version đầu của app chỉ có thể build the routes thông qua các con đường
 - Nhưng chỉ phù hợp cho khách di chuyển bằng ô tô và ko phải ai cũng thích lái xe khi đi du lịch
	- Ở những version sau, bạn thêm options cho tuyến đường đi bộ & phương tiện giao thông công cộng
	
- Tuy nhiên, đây chỉ mới là bắt đầu
	- Sau đó, bạn lên kế hoạch build thêm route cho người đi xe đạp
	- Thậm chí sau đó, một option khác để building routes qua tất cả các điểm du lịch của thành phố
	

![[oop-181.png]]

- Nhìn từ góc độ business thì app rất ok, nhưng phần technical khiến bạn nhức đầu:
	- Mỗi khi added new routring algorithm, main class doubled in size
	- Tại một số thời điểm, việc maintain trở nên khó khăn
	
- Bắt kỳ thay đổi nào với một trong các algorithms, cho dù sửa một simple bug hay một chút điều chỉnh of the street score đều sẽ ảnh hưởng đến toàn bộ class, tăng nguy cơ gây lỗi cho already-working code

-  Ngoài ra cũng ảnh hưởng đến teamwork
	- Trong việc resolving merge conflicts
	- Implementing new feature đòi hỏi phải change huge class, conflicting với code của người khác

# Solution

- The Strategy pattern gợi ý rằng class nên thực hiện do something specific theo nhiều cách khác nhau & extract all algorithms thành các separate classes called strategies

- The original class called `context`, phải có field để storing a reference đến một trong các strategies 
	- The context delegates(ủy thác) work cho strategy object được liên kết thay vì tự mình xử lý nó

- The context không quyết định chọn alrorithm thích hợp mà để client passes strategy mong muốn vào context class
	- Context class không biết nhiều về strategies
	- Nó works với all strategies thông qua common interface, only exposes single method để triggering the algorithm được đóng gói trong strategy đã chọn
	
- Bằng cách này, the context trở nên independent với concrete strategies, so you can add new alrorithms or modify mà không changing code của context hoặc strategies class













