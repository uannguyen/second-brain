![[oop-54.png]]

# Khái niệm

***Prototype is a creational design pattern that lets you copy existing objects without making your code dependent on their classes.***

- Cho phép copy objects hiện có mà không làm cho code của bạn phụ thuộc vào các classes của chúng

# Problem

- Giả sử ta có 1 objet và muốn tạo một bản copy

- => Phải tạo một new object của cùng một class sau đó truyền all fields của original object & copy values của chúng sang new object

```ts
Person originalPerson = new Person("John", 30, "123 Main St");
Person clonedPerson = new Person(originalPerson.getName(), originalPerson.getAge(), originalPerson.getAddress());
```


![[oop-55.png]]

- Nhưng cách này có một số nhược điểm:
	+ **Các fields private không thể sao chép**: một số fields hoặc thuộc tính của object có thể là private nên không thể truy cập từ ngoài object
	+ **Phụ thuộc vào class cụ thể**: Tạo ra bản sao cần phải biết cụ thể class object đó nên code trở nên phụ thuộc vào class 
	+ **Chỉ biết về giao diện**: Đôi khi ta chỉ có thông tin về interface mà object class đó implement mà ko hẳn biết chính xác

# Solution

- Prototy pattern ủy thác cloning process cho các objects thực tế đang muốn nhân bản. 
	+ Pattern sẽ declares một common interface cho tất cả object mà nó muốn cloning
	+ Interface này cho phép clone một object mà không coupling code với class của object đó.
	+ Thông thường, một interface chỉ chứa single `clone` method
	
- Việc implement clone method rất giống nhau đối với tất cả các classes
	+ Method `clone` này sẽ tạo 1 object của current class và mang tất cả các field values của old object sang một new object
	+ Thậm chí có thể copy private fields bới vì hầu hết các programming languages cho phép object truy cập private fields của object khác thuộc cùng một class
	
	![[oop-57.png]]

- Một object hỗ trợ cloning được gọi là `prototype`
	+ Khi object có hàng chục fields và hàng trăm configs, cloning chúng có thể phục vụ như là thay thế cho subclass
	
- Mô tả cách hoạt động: 
	+ Tạo một tập hợp các objects được cấu hình theo nhiều cách khác nhau
	+ Khi cần một object giống với object vừa cấu hình ở trên, ta chỉ cần clone một prototype thay vì constructing một new object từ đầu

# Real-World Analogy

- Trong thực tế, prototypes được sử dụng để thực hiện các thí nghiệm khác nhau trước khi bắt đầu sản xuất hàng loạt product
	+ Tuy nhiên, trong case này, prototypes không tham gia bất kỳ sản xuất thực tế nào, thay vào đó đóng vai trò thụ động
	![[oop-58.png]]

- Vì các prototypes không thực sự tự sao chép, nên một sự tương tự gần gũi hơn với mô hình là quá trình phân chia tế nào
	+ Sau khi phân chia, 1 cặp tế bào giống nhau được hình thành
	+ Tế bào ban đầu hoạt động như một prototype và đóng vai trò tích cực trong việc tạo bản sao

# Structure

## Basic Implement

![[oop-59.png]]
	

- 1. Prototype interface declares method `clone`
	+ Trong hầu hết các cases, chỉ có một `clone` method duy nhất
	+ Các class khác muốn thực hiện copy thì sẽ implement interface này

- 2. `Concrete Prototype` class implement cloning method của Prototype interface
	+ Ngoài việc copy data của object gốc vào một bản sao, method `clone` này cũng có thể xử lý một số cases đặc biệt của quá trình copy, như là copy các objects được liên kết, giải quyết các issues đệ quy, vv...
	
- 3. `Client code`: có thể copy bất kỳ object nào follows theo prototype interface


	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	




## Prototype registry implementation


