![[Pasted image 20240318133139.png]]
# KhÃ¡i niá»‡m

- Cung cáº¥p má»™t interface Ä‘á»ƒ táº¡o cÃ¡c Ä‘á»‘i tÆ°á»£ng trong má»™t superclass nhÆ°ng cho phÃ©p subclass thay Ä‘á»•i loáº¡i Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c táº¡o

- Äiá»u nÃ y giÃºp tÄƒng tÃ­nh flexibility cá»§a code vÃ  giáº£m sá»± phá»¥ thuá»™c vÃ o class cá»¥ thá»ƒ. Factory Method thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c há»‡ thá»‘ng mÃ  cÃ¡c objects cá»¥ thá»ƒ cáº§n Ä‘Æ°á»£c táº¡o ra theo conditions hoáº·c dynamic info tá»« user hoáº·c tá»« cÃ¡c pháº§n khÃ¡c cá»§a system

# ğŸ™ Problem 


![[oop-30.png]]

- Giáº£ sá»­ cÃ³ 1 app quáº£n lÃ½ háº­u cáº§n
- First version app chá»‰ cÃ³ thá»ƒ xá»­ lÃ½ váº­n chuyá»ƒn báº±ng xe táº£i
	=> Pháº§n lá»›n code Ä‘á»u náº±m trong Truck class
	
- Sau 1 thá»i gian, App trá»Ÿ nÃªn phá»• biáº¿n
	+ Má»—i ngÃ y cÃ³ hÃ ng chá»¥c requests y/c tá»« cÃ¡c Sea transportation companies Ä‘á»ƒ káº¿t há»£p sea logistics vÃ o App
	
- Giá» Ä‘Ã¢y, háº§u háº¿t code Ä‘á»u Ä‘Æ°á»£c ghÃ©p ná»‘i vá»›i Truck class. 
	=> Add Ships vÃ o app sáº½ y/c thay Ä‘á»•i toÃ n bá»™ codebase. 
	=> HÆ¡n ná»¯a, náº¿u sau nÃ y thÃªm báº¥t ká»³ 1 loáº¡i transportation nÃ o vÃ o app, sáº½ cáº§n pháº£i thá»±c hiá»‡n láº¡i táº¥t cáº£ nhá»¯ng thay Ä‘á»•i nÃ y
	
--- 
Cuá»‘i cÃ¹ng lÃ  sml => dáº«n Ä‘áº¿n viá»‡c mÃ£ trá»Ÿ nÃªn lá»™n xá»™n vá»›i cÃ¡c Ä‘iá»u kiá»‡n ráº½ nhÃ¡nh kiá»ƒm tra loáº¡i Ä‘á»‘i tÆ°á»£ng váº­n táº£i Ä‘á»ƒ xÃ¡c Ä‘á»‹nh hÃ nh vi cá»§a á»©ng dá»¥ng
	
# Solution

- Thay tháº¿ cÃ¡c cuá»™c gá»i xÃ¢y dá»±ng Ä‘á»‘i tÆ°á»£ng trá»±c tiáº¿p (sá»­ dá»¥ng toÃ¡n tá»­ `new`) báº±ng cÃ¡c cuá»™c gá»i Ä‘áº¿n má»™t `special factory method`

- CÃ¡c Ä‘á»‘i tÆ°á»£ng váº«n Ä‘Æ°á»£c táº¡o thÃ´ng qua toÃ¡n tá»­ má»›i, NhÆ°ng nÃ³ Ä‘Æ°á»£c gá»i tá»« bÃªn trong factory method

- CÃ¡c objects Ä‘Æ°á»£c returned báº±ng factory method thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  "products".
	
	![[oop-31.png]]

- Thoáº¡t nhÃ¬n, thay Ä‘á»•i nÃ y cÃ³ váº» vÃ´ nghÄ©a, just moved constructor call tá»« pháº§n nÃ y sang pháº§n khÃ¡c cá»§a program.
	- Tuy nhiÃªn, giá» ta cÃ³ thá»ƒ override factory method trong 1 subclass vÃ  thay Ä‘á»•i products class Ä‘Æ°á»£c táº¡o ra tá»« method

- CÃ³ 1 háº¡n cháº¿ nhá»:
	+ subclass chá»‰ return vá» cÃ¡c loáº¡i products khÃ¡c nhau náº¿u cÃ¡c products cÃ³ base class hoáº·c interface chung
	+ NgoÃ i ra, factory method trong base class pháº£i cÃ³ return type lÃ  interface nÃ y 

![[oop-32.png]]	
	
	
- Cáº£ 2 classes `Truck` & `Ship` nÃªn implement `Transport` interface, trong Ä‘Ã³ declares 1 method lÃ  `deliver()`

- Má»—i class implement method nÃ y khÃ¡c nhau:
	+ `Truck` váº­n chuyá»ƒn báº±ng Ä‘Æ°á»ng bá»™
	+ `Ship` váº­n chuyá»ƒn báº±ng Ä‘Æ°á»ng thá»§y
	
- Factory method trong `ReadLogistics` class returns vá» cÃ¡c objects `truck`, factory method trong SeaLogistics class returns vá» `ships` objects

- Code sá»­ dá»¥ng factory method(client code) khÃ´ng cÃ³ sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c products thá»±c táº¿ Ä‘Æ°á»£c returns vá» bá»Ÿi cÃ¡c subclass khÃ¡c nhau
- Client coi táº¥t cáº£ cÃ¡c products nhÆ° lÃ  abstract `Transport`

![[oop-33.png]]


# Structure

	![[oop-34.png]]

- 1. `Product` declares interface, chung cho táº¥t cáº£ cÃ¡c objects cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o bá»Ÿi creator vÃ  cÃ¡c subclasses cá»§a nÃ³
- 2. `Concrete Product` lÃ  cÃ¡c implement khÃ¡c nhau cá»§a `Product` interface
- 3. Class `Creator` declares factory method returns vá» cÃ¡c objects sáº£n pháº©m má»›i. Äiá»u quan trá»ng lÃ  return type cá»§a method nÃ y pháº£i khá»›p vá»›i `Product` interface
	- Báº¡n cÃ³ declares factory method lÃ  abstract Ä‘á»ƒ buá»™c táº¥t cáº£ cÃ¡c lá»›p csubclasses implement cÃ¡c phiÃªn báº£n riÃªng cá»§a method
	- Thay vÃ o Ä‘Ã³, base factory methodcÃ³ thá»ƒ tráº£ vá» má»™t sá»‘ loáº¡i product máº·c Ä‘á»‹nh.

	- viá»‡c táº¡o ra product khÃ´ng pháº£i lÃ  trÃ¡ch nhiá»‡m chÃ­nh cá»§a creator

	- ThÃ´ng thÆ°á»ng, class creator cÃ³ 1 sá»‘ core business login liÃªn quan Ä‘áº¿n products
	
	- Factory method giÃºp tÃ¡ch login nÃ y khá»i cÃ¡c Concrete product class
	
	- VD: 1 company phÃ¡t triá»ƒn pháº§n má»m lá»›n cÃ³ thá»ƒ cÃ³ bá»™ pháº­n training riÃªng cho láº­p trÃ¬nh viÃªn, tuy nhiÃªn chá»©c nÄƒng chÃ­nh cá»§a company lÃ  viáº¿t mÃ£, ko pháº£i sáº£n xuáº¥t Programmers.


# Code Example

```ts

// Interface cho cÃ¡c phÆ°Æ¡ng tiá»‡n váº­n chuyá»ƒn
interface Transport {
  deliver(): string;
}

// Lá»›p cá»¥ thá»ƒ Ä‘áº¡i diá»‡n cho xe táº£i
class Truck implements Transport {
  deliver(): string {
    return 'Delivering cargo by land';
  }
}

// Lá»›p cá»¥ thá»ƒ Ä‘áº¡i diá»‡n cho tÃ u biá»ƒn
class Ship implements Transport {
  deliver(): string {
    return 'Delivering cargo by sea';
  }
}

// Logistics cÆ¡ sá»Ÿ Ä‘áº¡i diá»‡n cho loáº¡i váº­n chuyá»ƒn chung
abstract class Logistics {
  abstract createTransport(): Transport;

  // Factory method
  planDelivery(): string {
    const transport = this.createTransport();
    return transport.deliver();
  }
}

// Logistics Ä‘Æ°á»ng bá»™ triá»ƒn khai factory method tráº£ vá» xe táº£i
class RoadLogistics extends Logistics {
  createTransport(): Transport {
    return new Truck();
  }
}

// Logistics Ä‘Æ°á»ng biá»ƒn triá»ƒn khai factory method tráº£ vá» tÃ u biá»ƒn
class SeaLogistics extends Logistics {
  createTransport(): Transport {
    return new Ship();
  }
}

// Client code
function clientCode(logistics: Logistics) {
  console.log(logistics.planDelivery());
}

// Sá»­ dá»¥ng Factory Method Pattern
const roadLogistics = new RoadLogistics();
clientCode(roadLogistics); // Output: Delivering cargo by land

const seaLogistics = new SeaLogistics();
clientCode(seaLogistics); // Output: Delivering cargo by sea

```
	
	