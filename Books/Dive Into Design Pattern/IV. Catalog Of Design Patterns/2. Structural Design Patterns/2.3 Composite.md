![[oop-85.png]]

# Khái niệm

***Composite is a structural design pattern that lets you compose objects into tree structures and then work with these structures as if they were individual objects.***

- Composite là một mẫu thiết kế cấu trúc cho phép soạn các đối tượng thành Tree structures và sau đó work với những cấu trúc này như thể chúng là những đối tượng riêng lẻ

# Problem

- Composite pattern chỉ có ý nghĩa khi core model của app có thể được represented dưới dạng tree

- Giả sử, tưởng tượng rằng ta có 2 loại objects: `Products` và `Box`
	- Một `Box` có thể chứa vài `Products` như một số lượng `Boxes` nhỏ hơn
	- Những `Boxes` nhỏ này cũng có thể chứa some `Products` hoặc thâm chí là `Boxes` nhỏ hơn nữa, vv...

![[oop-86.png]]

- Giả sử ta tạo một hệ thống sắp xếp thứ tự sử dụng các classes này
	- Đơn hàng có thể chứa các products đơn giản mà không cần wrapping, cũng như các boxes stuffed with products(nhồi SP)... và các boxes khác
	- Làm thế nào để xác định total price của đơn hàng như vậy ?
	
- Có thể thử cách tiếp cận trực tiếp:
	- Unwrap all boxes, go over tất cả products và tính tổng
	- Điều này có thể làm trong real world, nhưng trong program, nó không đơn giản như chạy một vòng lặp
	- Do phải biết các classes của `Products` và `Boxes`, mức độ lồng nhau của các boxess và cả các chi tiết khó chịu khác...
	- Tất cả những điều trên làm cho cách tiếp  cận trực tiếp trở nên quá khó xử hoặc thâm chí là không thể
	
# Solution

- Composite pattern gợi ý worl với `Products` và `Boxes` thông qua một common interface declares một method để calculating total price

- Method này sẽ work như nào ?
	- Đối với 1 product, nó chỉ đơn giản là return product's price
	- Đối với một box, nó sẽ loop qua từng item mà box chứa, lấy price và sau đó return total cho box này
	- Nếu một trong những items này là box nhỏ hơn, box đó cũng sẽ loop qua từng item ở trong đó, ... cho đến khi price của tất cả các components bên trong được calculated
	- Một box thậm chí có thể thêm some extra cost vào final price, chẳng hạn như packaging cost
	
	![[oop-87.png]]


	
	
	
	
	
	
	
	
	
	
	
	
	